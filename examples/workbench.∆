
# Long term syntax?
# data Position
# 	x f32
# 	y f32

# pos = Position
# 	x: 2.3
# 	y: 3.4

# Short term syntax?
# component Position { x f32, y f32, z f32 }
# component Velocity { dx f32, dy f32 }
# pos = Position { y 2.3, x 4.5, z 3.0 }
# vel = Velocity { dx 1.0, dy 0.5 }

# --------------------

# for Position p, Velocity v in ∆
# 	p += v

# component Player {
# 	p Position
# 	v Velocity
# }

# ∆(Player p)
# 	p.p += p.v

# ∆(Position p, Velocity v)
# 	| each(.p = )

# TODO(anissen): How to differentiate mutation of ∆ from simply creating a new ∆?
# ∆ = ∆(Position p, Velocity v)
# 	| map(.p += .v)

# ∆(Position p, Velocity v)
# 	p += v

# entities = ∆(Position p, Velocity v)

# entities
# 	| each
# 		.p += .v

# ∆ query
# 	Position p, Velocity v
# 		p += v
# 	Player p, IsTarget? t, !Dead
# 		t if :some t
# 			p.xyz = t

# --------------

# TODO:
# - Add a result diff to snapshot runs
# - Improve time steps for prism?
# - Initial query support for components
# - Exhaustiveness tests for `is`
# - Shorthand for partial `is`?

component Position { x f32, y f32 }
# component Unit
component Marker
# component Velocity { dx f32, dy f32, dz i32 }
# component Blah { y i32, xxx i32, text str }

# ∆ | new [Position { x 32.0, y 64.0 }, Velocity { dx 1.0, dy 0.5 }]

# e = ∆.new([Position{...}])

# e = ∆ | new [Position { x 32.0, y 64.0 }]

# ∆ | new [ Position { x 32.0, y 64.0 }, Velocity { dx 1.0, dy 0.5 } ]

# ∆ | new
# 	Position { x 32.0, y 64.0 }
# 	Velocity { dx 1.0, dy 0.5 }

# ∆ | new
# | set Position { x 32.0, y 64.0 }
# | set Velocity { dx 1.0, dy 0.5 }

# should this be [...] | create ?
# create [45, 66]
# create [Position { x 1.0, y 2.0 }, Blah { y 8, xxx 1 }, Marker]
# create [Position { x 4.0, y 1.0 }]
# create [Blah { y 7, xxx 5, text "World" }, Position { x 32.0, y 64.0 }, Velocity { dx 1.0, dy 0.5, dz 3 }]
# create [Unit, Position { y 4.0, x 1.0 }]
# create [Marker, Velocity { dx 1.0, dy 0.5, dz 3 }]
# create [Position { x 32.0, y 64.0 }, Blah { y 7, xxx 5, text "Hello" }]
# create [Position { x 48.0, y 34.0 }, Blah { y 14, xxx 10, text "Hello 2" }]
create [Position { x 22.0, y 33.0 }]
create [Position { x 48.0, y 34.0 }, Marker]

# query
# 	Unit, Position p
# 		("Unit has position ({p.x}, {p.y})") | log
# query
# 	Marker, Velocity v
# 		("Unit has velocity ({v.dx}, {v.dy}, {v.dz})") | log
a = 112
query
	Position p, Marker, Entity e
		("First: {p.x}") | log
		("Entity: {e}") | log
		destroy e
"after:" | log
query
	Position p
		p.y = 3.0 # TODO: p.y = 3 fails at runtime (missing type checking)
		("Second: {p.x}") | log

#	query
#		Blah b, Position p
#			("Blah has position ({p.x}, {p.y}), y {b.y}, xxx {b.xxx} and text '{b.text}'") | log
#			x = p.x
#			x | log
# 		# query
# 		# 	Unit u, Position p
# 		# 		("Unit has position ({p.x}, {p.y})") | log
